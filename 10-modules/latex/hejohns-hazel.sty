\ProvidesPackage{hejohns-hazel}[2021/07/02 - for phis]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% packages
    \RequirePackage{hejohns-colors}
    \RequirePackage{mathpartir}
    \RequirePackage{latexsym}
    \RequirePackage{stmaryrd}
    \RequirePackage{amssymb}
    \RequirePackage{thmtools}
    \RequirePackage{tikz}
    % https://tex.stackexchange.com/questions/12678/squiggly-arrows-in-tikz
    \usetikzlibrary{decorations.pathmorphing}
    \usetikzlibrary{arrows.meta}
    % https://tex.stackexchange.com/questions/317121/automatically-adding-page-breaks-into-long-array-environments
    \RequirePackage{array}
    \RequirePackage{longtable}
    \newcolumntype{L}{>{\(}l<{\)}}
    \newcolumntype{C}{>{\(}c<{\)}}
    \newcolumntype{R}{>{\(}r<{\)}}
    \setlength\tabcolsep{5pt}
    % https://tex.stackexchange.com/questions/29973/more-than-one-optional-argument-for-newcommand
    \RequirePackage{xparse}

    %% Joshua Dunfield macros
    \def\OPTIONConf{1}%
    \RequirePackage{joshuadunfield}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% syntax
    \newcommand{\knd}[1][]{\redit{\kappa#1}}
    \newcommand{\utyp}[1][]{\greenit{\hat{\tau#1}}}
    \newcommand{\typ}[1][]{\greenit{\tau#1}}
    \newcommand{\utypvar}[1][]{\greenit{t#1}}
    \newcommand{\typvar}[1][]{\greenit{t#1}}
    \newcommand{\uexp}[1][]{\blueit{\hat{\delta#1}}}
    \renewcommand{\exp}[1][]{\blueit{\delta#1}}
    \newcommand{\uexpvar}[1][]{\blueit{x#1}}
    \newcommand{\expvar}[1][]{\blueit{x#1}}
    \newcommand{\sigknd}[1][]{\orangeit{\xi#1}}
    \newcommand{\usig}[1][]{\purpleit{\hat{\sigma#1}}}
    \newcommand{\sig}[1][]{\purpleit{\sigma#1}}
    \newcommand{\usigvar}[1][]{\purpleit{s#1}}
    \newcommand{\sigvar}[1][]{\purpleit{s#1}}
    \newcommand{\umod}[1][]{\tealit{\hat{\mu#1}}}
    \renewcommand{\mod}[1][]{\tealit{\mu#1}}
    \newcommand{\umodvar}[1][]{\tealit{m#1}}
    \newcommand{\modvar}[1][]{\tealit{m#1}}
    \newcommand{\lab}[1][]{\mathit{lab#1}}

    \newcommand{\Type}{\redtt{Type}}
    \newcommand{\SKind}[2][]{\redtt{S_{#1}(#2)}}
    \newcommand{\KHole}{\redtt{KHole}}
    \newcommand{\DepFunKind}[2]{\redtt{\Pi_{#1}.{#2}}}
    \newcommand{\DepProdKind}[2]{\redtt{\Sigma_{#1}.{#2}}}

    \newcommand{\TypCFun}[2]{\greentt{\lambda #1.#2}}
    \newcommand{\TypCAp}[2]{\greentt{#1~#2}}
    \newcommand{\TypCPair}[2]{\greentt{\langle #1, #2\rangle}}
    \newcommand{\TypCPairPrjL}[1]{\greentt{\pi_1~#1}}
    \newcommand{\TypCPairPrjR}[1]{\greentt{\pi_2~#1}}
    \newcommand{\ListTyp}[1]{\greentt{[#1]}}
    % use violet instead of green?
    \newcommand{\TypCHole}[1][]{\greentt{\llparenthesis #1 \rrparenthesis}}
    \newcommand{\ModTypPrj}[2]{\greentt{#1.#2}}

    \newcommand{\Int}{\greentt{Int}}
    \newcommand{\Float}{\greentt{Float}}
    \newcommand{\Bool}{\greentt{Bool}}

    \newcommand{\uLetSig}[2]{\purplett{signature~#1=#2}\bluett{~in~\uexp}}
    \newcommand{\LetSig}[2]{\purplett{signature~#1=#2}\bluett{~in~\exp}}
    \newcommand{\uLetMod}[2]{\tealtt{module~#1=#2}\bluett{~in~\uexp}}
    \newcommand{\LetMod}[2]{\tealtt{module~#1=#2}\bluett{~in~\exp}}
    \newcommand{\uLetFunctor}[2]{\tealtt{functor~#1=#2}\bluett{~in~\uexp}}
    \newcommand{\LetFunctor}[2]{\tealtt{functor~#1=#2}\bluett{~in~\exp}}
    \newcommand{\uModTermPrj}[2]{\bluett{#1.#2}}
    \newcommand{\ModTermPrj}[2]{\bluett{#1.#2}}

    \newcommand*{\SSigKind}[1]{\orangett{SSigKind(#1)}}
    \newcommand*{\SigKHole}{\orangett{SigKHole}}

    \newcommand*{\uSig}{\Sig}
    \newcommand{\Sig}[1]{\purplett{\{#1\}}}
    \newcommand*{\uFunctorSig}{\FunctorSig}
    \newcommand{\FunctorSig}[2]{\purplett{\Pi_{#1}.{#2}}}
    \newcommand*{\uSigHole}{\SigHole}
    \NewDocumentCommand{\SigHole}{O{}O{}}{\purplett{\llparenthesis#1\rrparenthesis#2}}
    \newcommand*{\UnboundSigVar}[1][]{\uwave{\hphantom{.}\sigvar\hphantom{.}}}

    \newcommand{\Struct}[1]{\tealtt{\{#1\}}}
    \newcommand{\Functor}[2]{\tealtt{\lambda #1.#2}}
    \newcommand{\FunctorAp}[2]{\tealtt{#1~#2}}
    \newcommand{\SubModulePrj}[2]{\tealtt{#1.#2}}
    \newcommand{\ModHole}[1][]{\tealtt{\llparenthesis#1\rrparenthesis}}


    \newcommand{\usbnd}{\greyit{\hat{sbnd}}}
    \newcommand{\sbnd}{\greyit{sbnd}}
    \newcommand{\usbnds}{\greyit{\hat{sbnds}}}
    \newcommand{\sbnds}{\greyit{sbnds}}
    \newcommand{\usdec}{\greyit{\hat{sdec}}}
    \newcommand{\sdec}[1][]{\greyit{sdec#1}}
    \newcommand{\usdecs}{\greyit{\hat{sdecs}}}
    \newcommand{\sdecs}[1][]{\greyit{sdecs#1}}

    \newcommand*{\uOpaqueTypeSdec}[1]{\greentt{type~#1}}
    \newcommand*{\uTransparentTypeSdec}{\TypeSdec}
    \newcommand*{\uValSdec}{\ValSdec}
    \newcommand*{\TypeSdec}[2]{\greentt{type~#1\KndAnn #2}}
    \newcommand{\ValSdec}[2]{\bluett{val~#1\TypAnn #2}}
    \newcommand*{\uModSdec}{\ModSdec}
    \newcommand{\ModSdec}[2]{\tealtt{module~#1\SigAnn #2}}
    \newcommand*{\uFunctorSdec}{\FunctorSdec}
    \newcommand{\FunctorSdec}[2]{\tealtt{functor~#1\SigAnn #2}}

    \newcommand{\TypeSbnd}[2]{\greentt{type~#1 = #2}}
    \newcommand{\ValSbnd}[2]{\bluett{let~#1 = #2}}
    \newcommand{\ModSbnd}[2]{\tealtt{module~#1 = #2}}
    \newcommand{\FunctorSbnd}[2]{\tealtt{functor~#1 = #2}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% misc
    \newcommand*{\ExpVarCtx}[1][;]{\Gamma#1}
    \newcommand*{\TypVarCtx}[1][;]{\Phi#1}
    \newcommand*{\ModVarCtx}[1][;]{\Xi#1}
    \newcommand*{\SigVarCtx}[1][;]{\Psi#1}
    \newcommand*{\HoleCtx}[1][;]{\Delta#1}
    \newcommand{\dom}[1]{\mathsf{dom(}#1\mathsf{)}}
    \newcommand{\val}[1]{\mathsf{val(}#1\mathsf{)}}
    \newcommand*{\type}[2]{\mathsf{type(}#1, #2\mathsf{)}}
    \newcommand{\submodule}[1]{\mathsf{submodule(}#1\mathsf{)}}
    \renewcommand*{\hole}[1][]{\blackrm{u#1}}

    \newcommand{\hintpagebreak}{\pagebreak[3]} % 0-4; 2 too weak, 4 too strong
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% judgements
    % declarative
        \newcommand{\TypAsc}{\black{:}}
        \newcommand{\TypAssump}{\black{:}}
        \newcommand{\TypAnn}{\black{:}}
        \newcommand{\KndAsc}{\black{::}}
        \newcommand{\KndAssump}{\black{::}}
        \newcommand{\KndAnn}{\black{::}} % why do we have this?
        \newcommand*{\SigKndAsc}{\black{::_{\sig}}}
        \newcommand*{\SigKndAssump}{\black{::_{\sig}}}
        \newcommand{\SigAsc}{\black{:_{\mod}}}
        \newcommand{\SigAssump}{\black{:_{\mod}}}
        \newcommand{\SigAnn}{\black{:_{\mod}}}

        \newcommand{\ConsistentSubkindOp}{\lesssim}
        \NewDocumentCommand{\ConsistentSubkind}{O{\HoleCtx\TypVarCtx\ModVarCtx\SigVarCtx}mm}{\mathrm{#1 \vdash #2 \ConsistentSubkindOp #3}}
        \newcommand{\ConsistentSubSigKindOp}{\lesssim_{\sigknd}}
        \newcommand{\ConsistentSubSigKind}[3]{\mathrm{#1 \vdash #2 \ConsistentSubSigKindOp #3}}
        \newcommand*{\SubSdecOp}{\le_{\sdec}}
        \newcommand*{\SubSdec}[3]{\mathrm{#1 \vdash #2 \SubSdecOp #3}}

        \newcommand*{\TypeEquivOp}{\equiv}
        \NewDocumentCommand{\TypeEquiv}{O{\HoleCtx\TypVarCtx\ModVarCtx\SigVarCtx}mm}{\mathrm{#1 \vdash #2 \TypeEquivOp #3}}
        \newcommand*{\KindEquivOp}{\equiv}
        \NewDocumentCommand{\KindEquiv}{O{\HoleCtx\TypVarCtx\ModVarCtx\SigVarCtx}mm}{\mathrm{#1 \vdash #2 \KindEquivOp #3}}
        \newcommand*{\SigEquivOp}{\equiv}
        \newcommand*{\SigEquiv}[3]{\mathrm{#1 \vdash #2 \SigEquivOp #3}}
        \newcommand*{\SigKindEquiv}[3]{\mathrm{#1 \vdash #2 \equiv #3}}
        \newcommand*{\WellFormedAtType}[3]{\mathrm{#1 \vdash #2 \TypAsc #3}}
        \NewDocumentCommand{\WellFormedAtKind}{O{\HoleCtx\TypVarCtx\ModVarCtx\SigVarCtx}mm}{\mathrm{#1 \vdash #2 \KndAsc #3}}
        \newcommand*{\WellFormedAtSig}[3]{\mathrm{#1 \vdash #2 \SigAsc #3}}
        \newcommand*{\WellFormedAtSigKind}[3]{\mathrm{#1 \vdash #2 \SigKndAsc #3}}
    % algorithmic
        \newcommand{\Syn}[3]{#1 \vdash #2~\Rightarrow~#3}
        \newcommand{\Ana}[3]{#1 \vdash #2~\Leftarrow~#3}
        \newcommand{\SynElab}[5]{#1 \vdash #2~\Rightarrow~#3 \rightsquigarrow #4 \dashv #5}
        \newcommand{\AnaElab}[5]{#1 \vdash #2~\Leftarrow~#3 \rightsquigarrow #4 \dashv #5}
        \newcommand*{\ElabDegenerate}[4]{#1 \vdash #2 \rightsquigarrow #3 \dashv #4}
\endinput
